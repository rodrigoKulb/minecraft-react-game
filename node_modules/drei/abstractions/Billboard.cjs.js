'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var _extends = require('@babel/runtime/helpers/extends');
var _objectWithoutPropertiesLoose = require('@babel/runtime/helpers/objectWithoutPropertiesLoose');
var React = require('react');
var reactThreeFiber = require('react-three-fiber');
var shapes_generated_cjs = require('../shapes/generated.cjs.js');
var mergeRefs = require('react-merge-refs');

function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

var _extends__default = /*#__PURE__*/_interopDefaultLegacy(_extends);
var _objectWithoutPropertiesLoose__default = /*#__PURE__*/_interopDefaultLegacy(_objectWithoutPropertiesLoose);
var React__default = /*#__PURE__*/_interopDefaultLegacy(React);
var mergeRefs__default = /*#__PURE__*/_interopDefaultLegacy(mergeRefs);

var Billboard = /*#__PURE__*/React.forwardRef(function Billboard(_ref, ref) {
  var _ref$follow = _ref.follow,
      follow = _ref$follow === void 0 ? true : _ref$follow,
      _ref$lockX = _ref.lockX,
      lockX = _ref$lockX === void 0 ? false : _ref$lockX,
      _ref$lockY = _ref.lockY,
      lockY = _ref$lockY === void 0 ? false : _ref$lockY,
      _ref$lockZ = _ref.lockZ,
      lockZ = _ref$lockZ === void 0 ? false : _ref$lockZ,
      props = _objectWithoutPropertiesLoose__default['default'](_ref, ["follow", "lockX", "lockY", "lockZ"]);

  var localRef = React.useRef();
  reactThreeFiber.useFrame(function (_ref2) {
    var camera = _ref2.camera;
    if (!follow) return;

    if (localRef.current) {
      var prev = {
        x: localRef.current.rotation.x,
        y: localRef.current.rotation.y,
        z: localRef.current.rotation.z
      };
      localRef.current.lookAt(camera.position); // readjust any axis that is locked

      if (lockX) localRef.current.rotation.x = prev.x;
      if (lockY) localRef.current.rotation.y = prev.y;
      if (lockZ) localRef.current.rotation.z = prev.z;
    }
  });
  return /*#__PURE__*/React__default['default'].createElement(shapes_generated_cjs.Plane, _extends__default['default']({
    ref: mergeRefs__default['default']([localRef, ref])
  }, props));
});

exports.Billboard = Billboard;
