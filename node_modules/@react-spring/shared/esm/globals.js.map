{"version":3,"file":"globals.js","sourceRoot":"","sources":["../../src/globals.ts"],"names":[],"mappings":"AAIA,OAAO,EAAE,SAAS,EAAmB,MAAM,aAAa,CAAA;AACxD,OAAO,EAAE,IAAI,EAAE,MAAM,WAAW,CAAA;AAEhC,EAAE;AACF,WAAW;AACX,EAAE;AAEF,MAAM,CAAC,IAAI,wBAEmB,CAAA;AAE9B,MAAM,CAAC,IAAI,SAAS,GAAG,IAAI,SAAS,EAAE,CAAA;AAEtC,EAAE;AACF,WAAW;AACX,EAAE;AAEF,MAAM,CAAC,IAAI,EAGS,CAAA;AAIpB,MAAM,CAAC,IAAI,GAAG,GAAG,cAAM,OAAA,WAAW,CAAC,GAAG,EAAE,EAAjB,CAAiB,CAAA;AAExC,MAAM,CAAC,IAAI,UAAU,GAAG,IAAwC,CAAA;AAEhE,MAAM,CAAC,IAAI,aAAa,GAAG,KAAgB,CAAA;AAM3C,MAAM,CAAC,IAAI,qBAAqB,GAC9B,OAAO,MAAM,KAAK,WAAW,CAAC,CAAC,CAAC,MAAM,CAAC,qBAAqB,CAAC,CAAC,CAAC,cAAM,OAAA,CAAC,CAAC,EAAF,CAAE,CAAA;AAEzE,MAAM,CAAC,IAAI,cAAc,GAAG,UAAC,QAAoB,IAAK,OAAA,QAAQ,EAAE,EAAV,CAAU,CAAA;AAEhE,MAAM,CAAC,IAAI,WAAW,GAA4C,IAAI,CAAA;AA2BtE,MAAM,CAAC,IAAM,MAAM,GAAG,UAAC,OAAwB;;IAC7C,OAAA,CAAC;;;;;;;;;;6BAuBA,EAtBC,UAAE,EACF,YAAG,EACH,wBAAS,EACT,0BAAU,EACV,gCAAa,EACb,sDAAwB,EACxB,gDAAqB,EACrB,kCAAc,EACd,4BAAW,KAcX;AAvBF,CAuBE,CAAA;AAEJ,0BAA0B;AAC1B,SAAS,YAAY,CAAC,OAAY;IAChC,IAAM,OAAO,GAAQ,EAAE,CAAA;IACvB,KAAK,IAAM,GAAG,IAAI,OAAO,EAAE;QACzB,IAAI,OAAO,CAAC,GAAG,CAAC,KAAK,SAAS;YAAE,OAAO,CAAC,GAAG,CAAC,GAAG,OAAO,CAAC,GAAG,CAAC,CAAA;KAC5D;IACD,OAAO,OAAO,CAAA;AAChB,CAAC","sourcesContent":["import { FluidValue } from 'fluids'\n\nimport { OneOrMore } from './types.util'\nimport { InterpolatorConfig, InterpolatorArgs } from './types'\nimport { FrameLoop, OpaqueAnimation } from './FrameLoop'\nimport { noop } from './helpers'\n\n//\n// Required\n//\n\nexport let createStringInterpolator: (\n  config: InterpolatorConfig<string>\n) => (input: number) => string\n\nexport let frameLoop = new FrameLoop()\n\n//\n// Optional\n//\n\nexport let to: <In, Out>(\n  source: OneOrMore<FluidValue>,\n  args: InterpolatorArgs<In, Out>\n) => FluidValue<Out>\n\ndeclare const performance: { now: () => number }\n\nexport let now = () => performance.now()\n\nexport let colorNames = null as { [key: string]: number } | null\n\nexport let skipAnimation = false as boolean\n\ndeclare const window: {\n  requestAnimationFrame: (cb: (time: number) => void) => number\n}\n\nexport let requestAnimationFrame: (cb: (time: number) => void) => void =\n  typeof window !== 'undefined' ? window.requestAnimationFrame : () => -1\n\nexport let batchedUpdates = (callback: () => void) => callback()\n\nexport let willAdvance: (animations: OpaqueAnimation[]) => void = noop\n\n//\n// Configuration\n//\n\nexport interface AnimatedGlobals {\n  /** Returns a new `Interpolation` object */\n  to?: typeof to\n  /** Used to measure frame length. Read more [here](https://developer.mozilla.org/en-US/docs/Web/API/Performance/now) */\n  now?: typeof now\n  /** Provide a custom `FrameLoop` instance */\n  frameLoop?: typeof frameLoop\n  /** Provide custom color names for interpolation */\n  colorNames?: typeof colorNames\n  /** Make all animations instant and skip the frameloop entirely */\n  skipAnimation?: typeof skipAnimation\n  /** Provide custom logic for string interpolation */\n  createStringInterpolator?: typeof createStringInterpolator\n  /** Schedule a function to run on the next frame */\n  requestAnimationFrame?: typeof requestAnimationFrame\n  /** Event props are called with `batchedUpdates` to reduce extraneous renders */\n  batchedUpdates?: typeof batchedUpdates\n  /** @internal Exposed for testing purposes */\n  willAdvance?: typeof willAdvance\n}\n\nexport const assign = (globals: AnimatedGlobals): AnimatedGlobals =>\n  ({\n    to,\n    now,\n    frameLoop,\n    colorNames,\n    skipAnimation,\n    createStringInterpolator,\n    requestAnimationFrame,\n    batchedUpdates,\n    willAdvance,\n  } = Object.assign(\n    {\n      to,\n      now,\n      frameLoop,\n      colorNames,\n      skipAnimation,\n      createStringInterpolator,\n      requestAnimationFrame,\n      batchedUpdates,\n      willAdvance,\n    },\n    pluckDefined(globals)\n  ))\n\n// Ignore undefined values\nfunction pluckDefined(globals: any) {\n  const defined: any = {}\n  for (const key in globals) {\n    if (globals[key] !== undefined) defined[key] = globals[key]\n  }\n  return defined\n}\n"]}